<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" -ext WixUIExtension -ext WixUtilExtension -ext WixNetFxExtension
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -ext WixUtilExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <?define UpgradeCode = "611EFDF4-B339-49A0-AE1F-D1172B3878BC" ?>
    <?define ProductTitle = "Soritit" ?>
    <?define ProductName = "Soritit" ?>
    <?define ProductManufacturer = "Aldi Alimucaj" ?>    
    <?define VersionMin="0.0.1" ?> 
    <?define VersionMax="1.0.0" ?>
    
    
        
    <Product Id="*" Name="$(var.ProductTitle)" Language="1033" Version="!(bind.FileVersion.SORTIT.EXE)" Manufacturer="$(var.ProductManufacturer)" UpgradeCode="$(var.UpgradeCode)">
        <Package Description="Sorting files with different patterns" Manufacturer="$(var.ProductManufacturer)" Comments="$(var.ProductManufacturer)" InstallerVersion="300" Compressed="yes" />
        <Media Id="1" Cabinet="simple.cab" EmbedCab="yes" />
        <Icon Id="StartMenuIcon.exe" SourceFile="Sortit\bin\Release\Sortit.exe" />
        <MajorUpgrade  DowngradeErrorMessage="A later version of $(var.ProductTitle) is already installed. Setup will now exit."/> 
        <Icon Id="icon.ico" SourceFile="Sortit\Resources\format_indent_more.ico"/>
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />
        <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />
        
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="RELEASE" Name="$(var.ProductTitle)">
                    <Component Id="LOG4NET.DLL" DiskId="1" Guid="2C37F25C-AE5B-447C-985C-B3FF414A9913">
                        <File Id="LOG4NET.DLL" Name="log4net.dll" Source="Sortit\bin\Release\log4net.dll" />
                    </Component>
                    <Component Id="LOG4NET.XML" DiskId="1" Guid="1BEC5488-56D2-472B-9A21-59D4B2BEC8BC">
                        <File Id="LOG4NET.XML" Name="log4net.xml" Source="Sortit\bin\Release\log4net.xml" />
                    </Component>					
                    <Component Id="SORTIT.EXE.CONFIG" Guid="06AB8C08-C427-4872-9D23-7EF5742A5D72">
                        <File Id="SORTIT.EXE.CONFIG" Name="Sortit.exe.config" Source="Sortit\bin\Release\Sortit.exe.config" />
                    </Component>
                    <Component Id="SORTIT.EXE" DiskId="1" Guid="175581EC-D629-4AAC-AF47-F73AD1ED1D13">
                        <File Id="SORTIT.EXE" Name="Sortit.exe" Source="Sortit\bin\Release\Sortit.exe">
                            <Shortcut Id="ExeShortcut" Directory="ProgramMenuDir" Name="Sortit" Advertise="yes" Icon="StartMenuIcon.exe" IconIndex="0" />
                        </File>
                    </Component>
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDir" Name="$(var.ProductTitle)">
                    <Component Id="StartMenuShortcuts" Guid="64B7907D-72AC-43B1-A372-E1CE30F4540E">
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" />
                        <Shortcut Id="UninstallProduct" Name="Uninstall Sortit" Description="Uninstalls the Sortit and removes its services." Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" />
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
            <ComponentRef Id="LOG4NET.DLL" />
            <ComponentRef Id="LOG4NET.XML" />
            <ComponentRef Id="SORTIT.EXE.CONFIG" />
            <ComponentRef Id="SORTIT.EXE" />
            <ComponentRef Id="StartMenuShortcuts" />
        </Feature>
        
        <UI>
            <UIRef Id="WixUI_Minimal" />
            <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
        </UI>
        
        <Property Id="WixShellExecTarget" Value="[RELEASE]Sortit.exe" />
        <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />
        
        <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch $(var.ProductTitle)" />
        <PropertyRef Id="NETFRAMEWORK40FULL"/>
        <PropertyRef Id="NETFRAMEWORK45"/>
        <Condition Message="This application requires .NET Framework 4.0 or higher">Installed OR NETFRAMEWORK40FULL OR NETFRAMEWORK45</Condition>
    </Product>
</Wix>